<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ローン計算機 GUI</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 30px;
        }

        .controls-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid #e9ecef;
        }

        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .controls-header h2 {
            color: #2c3e50;
            font-size: 1.8em;
        }

        .scenario-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .scenario-selector select {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            min-width: 200px;
        }

        .scenario-selector button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            transition: all 0.3s;
        }

        .scenario-selector button:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        .input-group label {
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .input-group input, .input-group select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 20px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            transform: scale(1.2);
        }

        .checkbox-group label {
            font-size: 1.1em;
            color: #2c3e50;
            cursor: pointer;
        }

        .calculate-button {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .calculate-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }

        .results-section {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .results-header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .results-header h2 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 25px;
            background: #f8f9fa;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .summary-card:hover {
            transform: translateY(-3px);
        }

        .summary-card .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }

        .summary-card .value {
            font-size: 1.4em;
            font-weight: bold;
            color: #2c3e50;
        }

        .deduction-summary {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
            padding: 20px;
            margin: 20px;
            border-radius: 0 10px 10px 0;
        }

        .deduction-summary h3 {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .deduction-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .deduction-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #27ae60;
        }

        .table-container {
            padding: 25px;
            overflow-x: auto;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.95em;
        }

        .results-table th,
        .results-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #ddd;
        }

        .results-table th {
            background: #2c3e50;
            color: white;
            font-weight: bold;
            text-align: center;
            font-size: 0.9em;
        }

        .results-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .results-table tr:hover {
            background: #e3f2fd;
        }

        .results-table td:first-child {
            text-align: center;
            font-weight: bold;
            color: #2c3e50;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.1em;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #c62828;
        }

        @media (max-width: 768px) {
            .input-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }

            .controls-header {
                flex-direction: column;
                gap: 15px;
            }

            .scenario-selector {
                width: 100%;
                justify-content: center;
            }

            .results-table {
                font-size: 0.85em;
            }

            .results-table th,
            .results-table td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏠 ローン計算機</h1>
            <p>借入金額、金利、期間から月額返済額と年ごとの残金を計算します</p>
        </div>

        <div class="content">
            <!-- 入力セクション -->
            <div class="controls-section">
                <div class="controls-header">
                    <h2>📊 計算条件設定</h2>
                    <div class="scenario-selector">
                        <select id="scenarioSelect">
                            <option value="">シナリオを選択...</option>
                        </select>
                        <button onclick="loadScenario()">読込</button>
                    </div>
                </div>

                <div class="input-grid">
                    <div class="input-group">
                        <label for="loanAmount">💰 借入金額（円）</label>
                        <input type="number" id="loanAmount" value="30000000" step="100000">
                    </div>
                    <div class="input-group">
                        <label for="annualRate">📈 年利率（%）</label>
                        <input type="number" id="annualRate" value="1.5" step="0.1" min="0">
                    </div>
                    <div class="input-group">
                        <label for="years">📅 借入期間（年）</label>
                        <input type="number" id="years" value="35" step="1" min="1" max="50">
                    </div>
                </div>

                <div class="checkbox-group">
                    <input type="checkbox" id="hasDeduction" checked>
                    <label for="hasDeduction">🏡 住宅ローン控除を適用する（13年間、年末残高または4500万円の少ない方の0.7%）</label>
                </div>

                <button class="calculate-button" onclick="calculateLoan()">
                    🧮 ローン計算を実行
                </button>
            </div>

            <!-- 結果セクション -->
            <div class="results-section" id="results" style="display: none;">
                <div class="results-header">
                    <h2>📋 ローン計算結果</h2>
                    <p id="resultsSummaryText"></p>
                </div>

                <!-- サマリーカード -->
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="label">月額返済額</div>
                        <div class="value" id="monthlyPayment">-</div>
                    </div>
                    <div class="summary-card">
                        <div class="label">総支払額</div>
                        <div class="value" id="totalPayment">-</div>
                    </div>
                    <div class="summary-card">
                        <div class="label">総利息額</div>
                        <div class="value" id="totalInterest">-</div>
                    </div>
                    <div class="summary-card">
                        <div class="label">総控除額</div>
                        <div class="value" id="totalDeduction">-</div>
                    </div>
                    <div class="summary-card">
                        <div class="label">実質負担額</div>
                        <div class="value" id="actualPayment">-</div>
                    </div>
                </div>

                <!-- 住宅ローン控除サマリー -->
                <div class="deduction-summary" id="deductionSummary" style="display: none;">
                    <h3>🏡 住宅ローン控除期間（13年間）の詳細</h3>
                    <div class="deduction-grid">
                        <div class="deduction-item">
                            <span>13年間の総支払額:</span>
                            <span id="deduction13TotalPayment">-</span>
                        </div>
                        <div class="deduction-item">
                            <span>13年間の総利息額:</span>
                            <span id="deduction13TotalInterest">-</span>
                        </div>
                        <div class="deduction-item">
                            <span>13年間の総控除額:</span>
                            <span id="deduction13TotalDeduction">-</span>
                        </div>
                        <div class="deduction-item">
                            <span>13年間の実質負担額:</span>
                            <span id="deduction13ActualPayment">-</span>
                        </div>
                        <div class="deduction-item">
                            <span>13年目終了時の残債額:</span>
                            <span id="deduction13RemainingBalance">-</span>
                        </div>
                    </div>
                </div>

                <!-- 年次テーブル -->
                <div class="table-container">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h3 style="color: #2c3e50;">📈 年ごとの返済計画</h3>
                        <div style="display: flex; gap: 10px;">
                            <button onclick="exportToCSV()" style="background: #27ae60; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                                📊 CSV出力
                            </button>
                            <button onclick="toggleChart()" style="background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9em;" id="chartToggleBtn">
                                📈 グラフ表示
                            </button>
                        </div>
                    </div>
                    
                    <!-- グラフエリア -->
                    <div id="chartContainer" style="display: none; margin-bottom: 20px;">
                        <canvas id="loanChart" width="800" height="400"></canvas>
                    </div>
                    
                    <table class="results-table" id="resultsTable">
                        <thead>
                            <tr>
                                <th>年</th>
                                <th>年間返済額</th>
                                <th>元本返済額</th>
                                <th>利息支払額</th>
                                <th>残債額</th>
                                <th id="deductionColumn" style="display: none;">住宅ローン控除</th>
                            </tr>
                        </thead>
                        <tbody id="resultsTableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // 設定データを格納する変数
        let configData = null;
        let currentYearlyData = null;
        let loanChart = null;

        // ページロード時に設定ファイルを読み込み
        document.addEventListener('DOMContentLoaded', function() {
            loadConfigFile();
        });

        // 設定ファイルを読み込む
        async function loadConfigFile() {
            try {
                const response = await fetch('./loan-config.json');
                if (!response.ok) {
                    throw new Error('設定ファイルの読み込みに失敗しました');
                }
                configData = await response.json();
                populateScenarios();
            } catch (error) {
                console.error('設定ファイル読み込みエラー:', error);
                // デフォルト設定を使用
                configData = {
                    defaultConfig: {
                        loanAmount: 30000000,
                        annualRate: 1.5,
                        years: 35,
                        hasDeduction: false,
                        description: "デフォルト設定"
                    },
                    scenarios: []
                };
                populateScenarios();
            }
        }

        // シナリオ選択肢を追加
        function populateScenarios() {
            const select = document.getElementById('scenarioSelect');
            select.innerHTML = '<option value="">シナリオを選択...</option>';
            
            // デフォルト設定を追加
            const defaultOption = document.createElement('option');
            defaultOption.value = 'default';
            defaultOption.textContent = `デフォルト設定 - ${configData.defaultConfig.description}`;
            select.appendChild(defaultOption);

            // 各シナリオを追加
            configData.scenarios.forEach((scenario, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${scenario.name} - ${scenario.description}`;
                select.appendChild(option);
            });
        }

        // 選択されたシナリオを読み込む
        function loadScenario() {
            const select = document.getElementById('scenarioSelect');
            const selectedValue = select.value;
            
            if (selectedValue === '') return;
            
            let config;
            if (selectedValue === 'default') {
                config = configData.defaultConfig;
            } else {
                config = configData.scenarios[parseInt(selectedValue)];
            }

            // フォームに値を設定
            document.getElementById('loanAmount').value = config.loanAmount;
            document.getElementById('annualRate').value = config.annualRate;
            document.getElementById('years').value = config.years;
            document.getElementById('hasDeduction').checked = config.hasDeduction;
            
            // 自動計算
            calculateLoan();
        }

        // 数値をフォーマット（カンマ区切り）
        function formatNumber(num) {
            return Math.round(num).toLocaleString();
        }

        // 月額返済額を計算
        function calculateMonthlyPayment(loanAmount, annualRate, years) {
            const monthlyRate = annualRate / 100 / 12;
            const numberOfPayments = years * 12;
            
            if (monthlyRate === 0) {
                return loanAmount / numberOfPayments;
            }
            
            return loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numberOfPayments)) /
                   (Math.pow(1 + monthlyRate, numberOfPayments) - 1);
        }

        // 住宅ローン控除額を計算
        function calculateLoanDeduction(remainingBalance, year, hasDeduction) {
            if (!hasDeduction || year > 13) {
                return 0;
            }
            const deductionBase = Math.min(remainingBalance, 45000000);
            return deductionBase * 0.007;
        }

        // 年ごとの残金を計算
        function calculateYearlyBalance(loanAmount, monthlyPayment, annualRate, years, hasDeduction) {
            const monthlyRate = annualRate / 100 / 12;
            let remainingBalance = loanAmount;
            const yearlyData = [];

            for (let year = 1; year <= years; year++) {
                let yearlyPrincipal = 0;
                let yearlyInterest = 0;

                for (let month = 1; month <= 12; month++) {
                    if (remainingBalance <= 0) break;

                    const interestPayment = remainingBalance * monthlyRate;
                    const principalPayment = monthlyPayment - interestPayment;

                    yearlyInterest += interestPayment;
                    yearlyPrincipal += principalPayment;
                    remainingBalance -= principalPayment;

                    if (remainingBalance < 0) {
                        yearlyPrincipal += remainingBalance;
                        remainingBalance = 0;
                    }
                }

                yearlyData.push({
                    year: year,
                    yearlyPayment: monthlyPayment * 12,
                    yearlyPrincipal: yearlyPrincipal,
                    yearlyInterest: yearlyInterest,
                    remainingBalance: Math.max(0, remainingBalance),
                    loanDeduction: calculateLoanDeduction(Math.max(0, remainingBalance), year, hasDeduction)
                });

                if (remainingBalance <= 0) break;
            }

            return yearlyData;
        }

        // ローン計算を実行
        function calculateLoan() {
            const loanAmount = parseFloat(document.getElementById('loanAmount').value);
            const annualRate = parseFloat(document.getElementById('annualRate').value);
            const years = parseInt(document.getElementById('years').value);
            const hasDeduction = document.getElementById('hasDeduction').checked;

            if (!loanAmount || !annualRate || !years) {
                alert('すべての項目を入力してください。');
                return;
            }

            // 月額返済額を計算
            const monthlyPayment = calculateMonthlyPayment(loanAmount, annualRate, years);
            
            // 年ごとの詳細データを計算
            const yearlyData = calculateYearlyBalance(loanAmount, monthlyPayment, annualRate, years, hasDeduction);

            // 結果を表示
            displayResults(loanAmount, annualRate, years, hasDeduction, monthlyPayment, yearlyData);
        }

        // 結果を表示
        function displayResults(loanAmount, annualRate, years, hasDeduction, monthlyPayment, yearlyData) {
            // 現在のデータを保存
            currentYearlyData = yearlyData;
            
            // サマリー情報を計算
            const totalPayments = yearlyData.reduce((sum, data) => sum + data.yearlyPayment, 0);
            const totalInterest = yearlyData.reduce((sum, data) => sum + data.yearlyInterest, 0);
            const totalDeduction = yearlyData.reduce((sum, data) => sum + data.loanDeduction, 0);

            // サマリーテキストを更新
            document.getElementById('resultsSummaryText').textContent = 
                `借入金額: ${formatNumber(loanAmount)}円 / 年利率: ${annualRate}% / 借入期間: ${years}年`;

            // サマリーカードを更新
            document.getElementById('monthlyPayment').textContent = formatNumber(monthlyPayment) + '円';
            document.getElementById('totalPayment').textContent = formatNumber(totalPayments) + '円';
            document.getElementById('totalInterest').textContent = formatNumber(totalInterest) + '円';
            
            if (hasDeduction) {
                document.getElementById('totalDeduction').textContent = formatNumber(totalDeduction) + '円';
                document.getElementById('actualPayment').textContent = formatNumber(totalPayments - totalDeduction) + '円';
            } else {
                document.getElementById('totalDeduction').textContent = '適用なし';
                document.getElementById('actualPayment').textContent = formatNumber(totalPayments) + '円';
            }

            // 住宅ローン控除詳細を表示
            if (hasDeduction) {
                const data13Years = yearlyData.slice(0, Math.min(13, yearlyData.length));
                const payments13Years = data13Years.reduce((sum, data) => sum + data.yearlyPayment, 0);
                const interest13Years = data13Years.reduce((sum, data) => sum + data.yearlyInterest, 0);
                const deduction13Years = data13Years.reduce((sum, data) => sum + data.loanDeduction, 0);
                
                document.getElementById('deduction13TotalPayment').textContent = formatNumber(payments13Years) + '円';
                document.getElementById('deduction13TotalInterest').textContent = formatNumber(interest13Years) + '円';
                document.getElementById('deduction13TotalDeduction').textContent = formatNumber(deduction13Years) + '円';
                document.getElementById('deduction13ActualPayment').textContent = formatNumber(payments13Years - deduction13Years) + '円';
                
                if (yearlyData.length >= 13) {
                    document.getElementById('deduction13RemainingBalance').textContent = formatNumber(yearlyData[12].remainingBalance) + '円';
                } else {
                    document.getElementById('deduction13RemainingBalance').textContent = '0円';
                }
                
                document.getElementById('deductionSummary').style.display = 'block';
            } else {
                document.getElementById('deductionSummary').style.display = 'none';
            }

            // テーブルを更新
            updateResultsTable(yearlyData, hasDeduction);

            // 結果セクションを表示
            document.getElementById('results').style.display = 'block';
        }

        // 結果テーブルを更新
        function updateResultsTable(yearlyData, hasDeduction) {
            const tbody = document.getElementById('resultsTableBody');
            const deductionColumn = document.getElementById('deductionColumn');
            
            // 控除列の表示/非表示
            deductionColumn.style.display = hasDeduction ? '' : 'none';
            
            // テーブルボディをクリア
            tbody.innerHTML = '';
            
            // データを追加
            yearlyData.forEach(data => {
                const row = document.createElement('tr');
                
                let html = `
                    <td>${data.year}</td>
                    <td>${formatNumber(data.yearlyPayment)}円</td>
                    <td>${formatNumber(data.yearlyPrincipal)}円</td>
                    <td>${formatNumber(data.yearlyInterest)}円</td>
                    <td>${formatNumber(data.remainingBalance)}円</td>
                `;
                
                if (hasDeduction) {
                    html += `<td>${formatNumber(data.loanDeduction)}円</td>`;
                }
                
                row.innerHTML = html;
                tbody.appendChild(row);
            });
        }

        // CSV出力機能
        function exportToCSV() {
            if (!currentYearlyData) {
                alert('計算結果がありません。まず計算を実行してください。');
                return;
            }

            const hasDeduction = document.getElementById('hasDeduction').checked;
            let csvContent = hasDeduction 
                ? "年,年間返済額,元本返済額,利息支払額,残債額,住宅ローン控除\n"
                : "年,年間返済額,元本返済額,利息支払額,残債額\n";

            currentYearlyData.forEach(data => {
                let row = `${data.year},${Math.round(data.yearlyPayment)},${Math.round(data.yearlyPrincipal)},${Math.round(data.yearlyInterest)},${Math.round(data.remainingBalance)}`;
                if (hasDeduction) {
                    row += `,${Math.round(data.loanDeduction)}`;
                }
                csvContent += row + "\n";
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'loan_calculation_result.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // グラフ表示切り替え機能
        function toggleChart() {
            const container = document.getElementById('chartContainer');
            const button = document.getElementById('chartToggleBtn');
            
            if (container.style.display === 'none') {
                if (!currentYearlyData) {
                    alert('計算結果がありません。まず計算を実行してください。');
                    return;
                }
                container.style.display = 'block';
                button.textContent = '📈 グラフ非表示';
                createChart();
            } else {
                container.style.display = 'none';
                button.textContent = '📈 グラフ表示';
                if (loanChart) {
                    loanChart.destroy();
                    loanChart = null;
                }
            }
        }

        // グラフ作成
        function createChart() {
            const ctx = document.getElementById('loanChart').getContext('2d');
            
            if (loanChart) {
                loanChart.destroy();
            }

            const years = currentYearlyData.map(data => data.year);
            const remainingBalance = currentYearlyData.map(data => data.remainingBalance);
            const yearlyInterest = currentYearlyData.map(data => data.yearlyInterest);
            const yearlyPrincipal = currentYearlyData.map(data => data.yearlyPrincipal);

            loanChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: '残債額',
                            data: remainingBalance,
                            borderColor: '#3498db',
                            backgroundColor: 'rgba(52, 152, 219, 0.1)',
                            fill: true,
                            yAxisID: 'y'
                        },
                        {
                            label: '年間利息額',
                            data: yearlyInterest,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            fill: false,
                            yAxisID: 'y1'
                        },
                        {
                            label: '年間元本返済額',
                            data: yearlyPrincipal,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            fill: false,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        x: {
                            display: true,
                            title: {
                                display: true,
                                text: '年数'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: '残債額（円）'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + '円';
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: '年間金額（円）'
                            },
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + '円';
                                }
                            }
                        },
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: 'ローン返済推移グラフ'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + '円';
                                }
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>